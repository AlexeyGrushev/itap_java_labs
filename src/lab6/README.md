# Лабораторная работа №6: Работа с коллекциями

## Описание

Данная лабораторная работа посвящена изучению коллекций в Java. Работа включает использование `Map` для подсчета частоты слов, создание обобщенного класса стека на основе массива и применение потокобезопасной коллекции `CopyOnWriteArrayList` для учета продаж.

## Структура проекта

```
src/lab6/
├── TopWords.java        # Задание 1: Топ-10 частых слов
├── Stack.java           # Задание 2: Обобщенный стек
├── SalesTracker.java    # Задание 3: Учет продаж
├── text.txt             # Тестовый файл для задания 1
└── README.md            # Документация (этот файл)
```

## Запуск программы

### Компиляция и запуск из корня проекта

```bash
# Задание 1 - TopWords
javac src/lab6/TopWords.java
java -cp src lab6.TopWords

# Задание 2 - Stack
javac src/lab6/Stack.java
java -cp src lab6.Stack

# Задание 3 - SalesTracker
javac src/lab6/SalesTracker.java
java -cp src lab6.SalesTracker
```

### Компиляция всех файлов сразу

```bash
javac src/lab6/*.java
```

## Описание заданий

### Задание 1: Топ-10 самых частых слов

**Файл:** `TopWords.java`

**Описание:** Программа считывает текстовый файл и выводит топ-10 самых часто встречающихся слов.

**Используемые коллекции:**
- `HashMap<String, Integer>` - для хранения слов и их количества
- `ArrayList<Map.Entry<String, Integer>>` - для сортировки результатов

**Алгоритм работы:**
1. Чтение файла построчно с помощью `Scanner`
2. Разбиение текста на слова
3. Подсчет количества каждого слова в `HashMap`
4. Сортировка по убыванию количества повторений
5. Вывод топ-10 слов

**Пример работы:**
```
Топ-10 самых частых слов:
java: 7
и: 3
программирование: 2
программирования: 2
на: 2
для: 2
разработки: 1
позволяет: 1
создавать: 1
различные: 1
```

**Особенности реализации:**
- Кодировка UTF-8 для корректного чтения кириллицы
- Удаление знаков препинания с помощью regex `[^а-яa-z]`
- Приведение к нижнему регистру для унификации
- Использование `Comparator` для сортировки

---

### Задание 2: Обобщенный класс Stack

**Файл:** `Stack.java`

**Описание:** Реализация стека (LIFO - Last In First Out) на основе массива с использованием обобщений.

**Методы класса:**
- `push(T element)` - добавление элемента в стек
- `pop()` - извлечение и удаление верхнего элемента
- `peek()` - просмотр верхнего элемента без удаления

**Пример использования:**
```java
Stack<Integer> stack = new Stack<>(10);
stack.push(1);
stack.push(2);
stack.push(3);
System.out.println(stack.pop());   // Вывод: 3
System.out.println(stack.peek());  // Вывод: 2
stack.push(4);
System.out.println(stack.pop());   // Вывод: 4
```

**Пример работы:**
```
3
2
4
```

**Особенности реализации:**
- Использование обобщенного типа `<T>`
- Приведение массива объектов к типу `T[]`
- Проверка переполнения и пустоты стека
- Аннотация `@SuppressWarnings("unchecked")` для подавления предупреждений

**Обработка ошибок:**
- Выброс `RuntimeException` при переполнении стека
- Выброс `RuntimeException` при попытке извлечь из пустого стека

---

### Задание 3: Учет продаж в магазине

**Файл:** `SalesTracker.java`

**Описание:** Программа для учета проданных товаров с возможностью одновременного чтения и записи.

**Используемая коллекция:**
- `CopyOnWriteArrayList<Product>` - потокобезопасный список

**Преимущества CopyOnWriteArrayList:**
- Безопасность при многопоточном доступе
- Эффективное чтение без блокировок
- Подходит для случаев, когда чтение происходит чаще записи

**Методы класса:**
- `addSale(String name, double price)` - добавление проданного товара
- `showSales()` - вывод списка всех продаж
- `getTotalSum()` - подсчет общей суммы продаж
- `getMostPopular()` - определение самого популярного товара

**Пример использования:**
```java
SalesTracker tracker = new SalesTracker();
tracker.addSale("Hleb", 50.0);
tracker.addSale("Moloko", 80.0);
tracker.addSale("Hleb", 50.0);
tracker.showSales();
System.out.println("Obshaya summa: " + tracker.getTotalSum());
System.out.println("Populyarnyj tovar: " + tracker.getMostPopular());
```

**Пример работы:**
```
Proданные tовары:
Hleb - 50.0 rub.
Moloko - 80.0 rub.
Hleb - 50.0 rub.
Maslo - 150.0 rub.
Moloko - 80.0 rub.
Hleb - 50.0 rub.

Obshaya summa prodazh: 460.0 rub.
Samyj populyarnyj tovar: Hleb
```

**Особенности реализации:**
- Вспомогательный класс `Product` для хранения названия и цены
- Использование `HashMap` для подсчета популярности товаров
- Метод `getOrDefault()` для упрощения подсчета

---

## Сравнение коллекций

| Коллекция | Задание | Особенности | Сложность операций |
|-----------|---------|-------------|-------------------|
| `HashMap<K,V>` | 1 | Быстрый поиск по ключу, неупорядоченная | O(1) - поиск |
| `ArrayList<E>` | 1 | Динамический массив, быстрый доступ | O(1) - доступ |
| `Array (T[])` | 2 | Фиксированный размер, быстрый доступ | O(1) - доступ |
| `CopyOnWriteArrayList<E>` | 3 | Потокобезопасный, копирование при записи | O(n) - запись |

## Технические требования

- **Java версия:** 8 или выше
- **Кодировка:** UTF-8 (для корректного отображения кириллицы)
- **Зависимости:** стандартная библиотека Java
  - `java.util.HashMap`
  - `java.util.ArrayList`
  - `java.util.Map`
  - `java.util.Collections`
  - `java.util.Scanner`
  - `java.util.concurrent.CopyOnWriteArrayList`

## Ключевые концепции

### Обобщения (Generics)

Использование обобщенного типа `<T>` позволяет создавать классы и методы, работающие с любыми типами данных:

```java
public class Stack<T> {
    private T[] data;

    public void push(T element) {
        // ...
    }
}
```

### Map и подсчет частоты

Паттерн для подсчета частоты элементов:

```java
Map<String, Integer> wordCount = new HashMap<>();
wordCount.put(word, wordCount.getOrDefault(word, 0) + 1);
```

### Сортировка Map по значениям

```java
List<Map.Entry<String, Integer>> list = new ArrayList<>(map.entrySet());
Collections.sort(list, (o1, o2) -> o2.getValue().compareTo(o1.getValue()));
```

### CopyOnWriteArrayList

Потокобезопасная коллекция, создающая копию массива при каждой модификации:

```java
CopyOnWriteArrayList<Product> sales = new CopyOnWriteArrayList<>();
sales.add(new Product("Item", 100.0));  // Создает новую копию массива
```

## Возможные улучшения

### Задание 1
- Игнорирование стоп-слов (предлоги, союзы)
- Поддержка различных кодировок
- Параметризация количества выводимых слов
- Обработка чисел и специальных символов

### Задание 2
- Динамическое увеличение размера стека
- Метод `size()` для получения количества элементов
- Метод `isEmpty()` для проверки пустоты
- Итератор для обхода элементов

### Задание 3
- Сохранение данных в файл/базу данных
- Группировка продаж по дате
- Статистика по категориям товаров
- Экспорт отчетов

## Примечания

- При работе с кириллицей важно указывать кодировку UTF-8
- `CopyOnWriteArrayList` не подходит для частых операций записи
- Обобщения проверяются только на этапе компиляции (type erasure)
- При больших объемах данных рекомендуется использовать потоки (Streams API)

## Автор

Лабораторная работа выполнена в рамках курса "Информационные технологии и программирование" (ИТИП).

## Лицензия

Данный код предназначен для образовательных целей.